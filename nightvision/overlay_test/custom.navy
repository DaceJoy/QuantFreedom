// Navy ~ 0.1-lite

// <ds>Sparse data: points, squares, crosses, triangles</ds>
// Format: [<timestamp>, <value>, <?direction>]
// <value> :: Price/value
// <?direction> :: Triangle direction: 1 | -1

[OVERLAY name=Sparse, ctx=Canvas, verion=1.0.0]

// Overlay props
prop('color', { type: 'Color', def: '#898989' })
prop('size', { type: 'number', def: 10 })
prop('shape', {
    type: 'string',
    def: 'point',
    options: ['point', 'square', 'cross', 'triangle']
})

// Draw call
draw(ctx) {
    const layout = $core.layout
    const view = $core.view

    ctx.fillStyle = $props.color
    ctx.strokeStyle = $props.color

    drawArcs(ctx, view, layout)
}

drawArcs(ctx, view, layout) {
    const radius = $props.size
    const data = view.src
    ctx.beginPath()
    for (var i = view.i1, n = view.i2; i <= n; i++) {
        let p = data[i]
        let x = layout.ti2x(p[0], i)
        let y = layout.value2y(p[1])
        ctx.moveTo(x+radius, y)
        ctx.arc(x, y, radius, 0, Math.PI * 2, false)
    }
    ctx.fill()
}