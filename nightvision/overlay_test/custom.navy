
// Navy ~ 0.1-lite

// <ds>Simple trades</ds>
// Format: [<timestamp>, <dir>, <price>, <?label>]
// <dir> :: 1 for buy -1 for sell
// <price> :: trade price
// <?label> :: trade label
[OVERLAY name=Trades, ctx=Canvas, version=1.0.0]

prop('buyColor', {  type: 'color', def: '#08b2c6' })
// prop('sellColor', {  type: 'color', def: '#e42633' })
prop('radius', {  type: 'number', def: 4 })
// prop('showLabels', {  type: 'boolean', def: true })
// prop('markerOutline', {  type: 'boolean', def: true })
// prop('outlineWidth', {  type: 'number', def: 4 })

// Draw function (called on each update)
// Library provides a lot of useful variables to make
// overlays ($core in the main collection)
draw(ctx) {
    const layout = $core.layout
    const data = $core.data // Full dataset

    ctx.fillStyle = $props.buyColor
    ctx.beginPath()
    iterArcs(ctx, data, layout)
    ctx.fill()

}

// Iter through arcs
iterArcs(ctx, data, layout) {
    const radius = $props.radius
    let p = data[2]
    let x = layout.ti2x(p[0])
    let y = layout.value2y(p[2])
    ctx.moveTo(x+radius, y)
    ctx.arc(x, y, radius, 0, Math.PI * 2, false)
}